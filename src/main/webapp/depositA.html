<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bank A - Para YatÄ±r</title>
    <link rel="stylesheet" href="styles/main.css">
</head>
<body>
<div class="container bank-page">
    <h1 class="main-title" onclick="window.location.href='index.html'">Interbank Payment Service</h1>

    <div class="bank-header">
        <h2>Bank A - Para YatÄ±r</h2>
        <button class="btn-back" onclick="window.location.href='bankA.html'">Geri</button>
    </div>

    <div class="bank-content-box bank-a-box">
        <div class="user-info">
            <p id="user-name"></p>
            <p id="user-email"></p>
            <p id="user-balance"></p>
        </div>

        <div class="transaction-form">
            <h3>ðŸ’° Para YatÄ±rma Ä°ÅŸlemi</h3>
            <form onsubmit="return handleDeposit(event)">
                <div class="form-group">
                    <label for="amount">YatÄ±rÄ±lacak Miktar (TL)</label>
                    <input type="number" id="amount" name="amount" required 
                           placeholder="Ã–rn: 1000" min="1" step="0.01">
                </div>

                <div class="form-group">
                    <label for="description">AÃ§Ä±klama (Ä°steÄŸe BaÄŸlÄ±)</label>
                    <textarea id="description" name="description" rows="3" 
                              placeholder="Ä°ÅŸlem aÃ§Ä±klamasÄ±..."></textarea>
                </div>

                <div id="message" class="message" style="display: none;"></div>

                <button type="submit" class="btn-submit btn-bank-a">YatÄ±r</button>
                <button type="button" class="btn-cancel" onclick="window.location.href='bankA.html'">Ä°ptal</button>
            </form>
        </div>
    </div>
</div>

<script src="scripts/login.js"></script>
<script>
    // Sayfa yÃ¼klendiÄŸinde kullanÄ±cÄ± bilgilerini gÃ¶ster
    window.onload = function() {
        const isLoggedIn = sessionStorage.getItem('bankA_logged_in') === 'true';
        
        if (!isLoggedIn) {
            alert('LÃ¼tfen Ã¶nce giriÅŸ yapÄ±n!');
            window.location.href = 'bankA.html';
            return;
        }

        const userRaw = sessionStorage.getItem('bankA_user');
        if (userRaw) {
            try {
                const user = JSON.parse(userRaw);
                document.getElementById('user-name').textContent = 'Ä°sim: ' + (user.name || '');
                document.getElementById('user-email').textContent = 'Email: ' + (user.email || '');
                document.getElementById('user-balance').textContent = 'Mevcut Bakiye: ' + 
                    (typeof user.balance === 'number' ? user.balance.toFixed(2) : '0.00') + ' TL';
            } catch (e) {
                console.error('KullanÄ±cÄ± bilgisi okunamadÄ±', e);
            }
        }
    };

    function handleDeposit(event) {
        event.preventDefault();
        
        const amount = parseFloat(document.getElementById('amount').value);
        const description = document.getElementById('description').value;
        const messageDiv = document.getElementById('message');

        if (!amount || amount <= 0) {
            showMessage('LÃ¼tfen geÃ§erli bir miktar girin!', 'error');
            return false;
        }

        // KullanÄ±cÄ± bilgilerini al
        const user = JSON.parse(sessionStorage.getItem('bankA_user'));
        
        // Bakiyeyi gÃ¼ncelle
        user.balance = parseFloat(user.balance) + amount;
        sessionStorage.setItem('bankA_user', JSON.stringify(user));

        // BaÅŸarÄ± mesajÄ± gÃ¶ster
        showMessage(`âœ“ ${amount.toFixed(2)} TL baÅŸarÄ±yla yatÄ±rÄ±ldÄ±!`, 'success');

        // 2 saniye sonra bankA.html'e yÃ¶nlendir
        setTimeout(() => {
            window.location.href = 'bankA.html';
        }, 2000);

        return false;
    }

    function showMessage(text, type) {
        const messageDiv = document.getElementById('message');
        messageDiv.textContent = text;
        messageDiv.className = 'message ' + type;
        messageDiv.style.display = 'block';
    }
</script>
</body>
</html>